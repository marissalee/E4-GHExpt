---
title: "E4 manuscript Results - Using ggplot"
author: "Marissa Lee"
date: "September 26, 2014"
output:
  pdf_document: default
  html_document: default
---
*Filename: e4_ms_results.Rmd'*

*A. This code needs the following files:*  

1. In the folder 'e4DataPackage_092614'
  + 'e4_potData.txt'
  + 'e4_potData_dictionary.txt'
2. In the folder 'e4CodePackage_100614'
  + 'e4_cleanCode.R'
  + 'e4_calcsiCode.R'
  + 'mytheme.R'
  + 'e4_Fig2stats.R' and 'e4_makeFig2.R' --> both reference --> 'e4_prepdfFig2.R'
  + 'e4_Fig3stats.R' and 'e4_makeFig3.R' --> both reference --> 'e4_prepdfFig3.R'
  + 'e4_Fig4stats.R' and 'e4_makeFig4.R' --> both reference --> 'e4_prepdfFig4.R'

*B. This code does the following things:*  

1. Clean raw dataset (run external code)
2. Make plots and the stats that support them
    + Fig2. Species' biomass
    + Fig3. Soil measures under monocultures and M.v. density alone
    + Fig4. Soil measures under mixture pots plotted against M.v. biomass and total biomass


*******************

#1. Clean raw dataset (run external code)
```{r,echo=TRUE}
source('e4CodePackage_100614/e4_cleanCode.R')
#str(data)
```

*******************

#2. Plot  

###Fig2 : Plant biomasses vs density trt
```{r, echo=TRUE}
source('e4CodePackage_100614/e4_Fig2stats.R') #this file is actually empty, it just references the prepdf

# panel a letters
tukpval<-data.frame(lm.fig2a$tukys$'mvtrt:comptrt')
p<-round(tukpval$p.adj, digits=2)
nam<-row.names(tukpval)
tuks<-data.frame(nam,p)

#within P
wP<-grep('..P...P', tuks$nam)
tuks[wP,] # all mvtrt levels are different except 1 to 2

#within S
wS<-grep('..S...S', tuks$nam)
tuks[wS,] # none of the levels are different

#within mvtrt levels
wmvtrt0<-grep('0...0..', tuks$nam)
wmvtrt1<-grep('1...1..', tuks$nam)
wmvtrt2<-grep('2...2..', tuks$nam)
wmvtrt4<-grep('4...4..', tuks$nam)
wmvtrt5<-grep('5...5..', tuks$nam)
tuks[wmvtrt0,] # not diff
tuks[wmvtrt1,] # diff (0.01)
tuks[wmvtrt2,] # diff (<0.01)
tuks[wmvtrt4,] # diff (<0.01)
tuks[wmvtrt5,] # diff (<0.01)


#summaries
sum.fig2a
sum.fig2b.mivi
sum.fig2b.comp
sum.fig2c

#lme4
lme.fig2a
lme.fig2b.mivi
lme.fig2b.comp
lme.fig2c

#lm
lm.fig2a
lm.fig2b.mivi
lm.fig2b.comp
lm.fig2c

#plot
source('e4CodePackage_100614/e4_makeFig2.R')
fig2

```



###Fig3 : Monocultures vs soil measurements
```{r, echo=TRUE}
source('e4CodePackage_100614/e4_Fig3stats.R')

#summaries
sum.fig3

#lme4
lme.fig3

#lm
lm.fig3

#plot
source('e4CodePackage_100614/e4_makeFig3.R')
fig3

```



##Fig4 : Mivi biomass vs soil measures w/o neighbors
```{r,echo=TRUE}
source('e4CodePackage_100614/e4_Fig4stats.R')

#summaries
sum.fig4

#lme4
lme.fig4

#lm
lm.fig4

#plot
source('e4CodePackage_100614/e4_makeFig4.R')
fig4

```



##Fig5. Mixture plant biomass vs soil measures
+ Calculate the change in soil measurement values in the presence of M.v. (run external code)
```{r,echo=TRUE}
source('e4CodePackage_100614/e4_calcsiCode.R')
#str(datas)
```

+ Fig 5
```{r,echo=TRUE}
source('e4CodePackage_100614/e4_Fig5stats.R')

#for mivi
sum.fig5.mivi
lme.fig5.mivi
lm.fig5.mivi

#for total
sum.fig5.total
lme.fig5.total
lm.fig5.total


#plot
source('e4CodePackage_100614/e4_makeFig5.R')
fig5

```



*******************

#3. Other stats????

### Predict soil measurement using mivi biomass, compabund, and total
+ Set up model fxns (run external code.... make these into mixed effects models)  
```{r, echo=TRUE}
#str(datas)
datas2<-datas
source('e4CodePackage_100614/e4_fitmodCode.R')
#ModFxn1
#ModFxn2
#ModFxn3
```
+ Set up generic fxn to pull out info from each fitted model 
+ Fit the models  
+ Organize fitted model results into tables; view the fitted model results
+ Significant model terms

Model 1. sF = (mivi * beta)  
```{r,echo=FALSE}
#dim(modl1)
PvalSumm(modl1, 0.1)
```
  
Model 2. sF = (mivi * beta) + (compabund * beta2) + ((mivi * compabund) * beta3)  
```{r,echo=FALSE}
#dim(modl2)
PvalSumm(modl2, 0.1)
```
  
Model 3. sF = (total * beta)  
```{r,echo=FALSE}
#dim(modl3)
PvalSumm(modl3, 0.1)
```








